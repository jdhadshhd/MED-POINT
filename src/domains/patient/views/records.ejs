<!-- Patient Medical Records -->
<div class="page-header">
  <div class="page-title">
    <h2><i class="fas fa-file-medical-alt"></i> Medical Records</h2>
    <p>View your medical history and records</p>
  </div>
</div>

<div class="dashboard-card">
  <% if (records.length === 0) { %>
  <div class="empty-state" style="text-align: center; padding: 80px;">
    <i class="fas fa-file-medical" style="font-size: 72px; color: #ccc; margin-bottom: 20px;"></i>
    <h3 style="color: var(--Paraghfont); margin-bottom: 10px;">No Medical Records</h3>
    <p style="color: #888;">Your medical records will appear here once created by your doctor.</p>
  </div>
  <% } else { %>
  <div class="records-list">
    <% records.forEach(function(record) { %>
    <div class="record-card">
      <div class="record-header">
        <div class="record-doctor">
          <div class="doctor-avatar">
            <%= record.doctor.name.charAt(0).toUpperCase() %>
          </div>
          <div>
            <strong>Dr. <%= record.doctor.name %></strong>
            <span class="record-date"><i class="fas fa-clock"></i> <%= new Date(record.createdAt).toLocaleDateString() %></span>
          </div>
        </div>
        <% if (record.muacStatus) { %>
        <span class="muac-badge muac-<%= record.muacStatus.toLowerCase() %>">
          <i class="fas fa-ruler"></i> MUAC: <%= record.muacValue %> cm
        </span>
        <% } %>
      </div>
      <p class="record-notes"><%= record.notes %></p>
      <% if (record.files && record.files.length > 0) { %>
      <div class="record-files">
        <strong><i class="fas fa-paperclip"></i> Attached Files:</strong>
        <ul>
          <% record.files.forEach(function(file) { %>
          <li>
            <a href="/uploads/<%= file.filePath %>" target="_blank">
              <i class="fas fa-file-alt"></i> <%= file.originalName %>
            </a>
            <span class="file-size">(<%= (file.size / 1024).toFixed(1) %> KB)</span>
          </li>
          <% }); %>
        </ul>
      </div>
      <% } %>
    </div>
    <% }); %>
  </div>
  <% } %>
</div>

<style>
.records-list {
  display: flex;
  flex-direction: column;
  gap: 20px;
  margin-top: 20px;
}

.record-card {
  padding: 25px;
  background: #f8f9fa;
  border-radius: 12px;
  border-left: 4px solid var(--navcolor);
}

.record-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 15px;
}

.record-doctor {
  display: flex;
  align-items: center;
  gap: 12px;
}

.doctor-avatar {
  width: 45px;
  height: 45px;
  border-radius: 50%;
  background: linear-gradient(135deg, var(--navcolor), var(--spanfonts));
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 600;
  font-size: 18px;
}

.record-date {
  display: block;
  font-size: 13px;
  color: #888;
  margin-top: 3px;
}

.record-date i {
  margin-right: 5px;
}

.record-notes {
  margin: 0;
  line-height: 1.7;
  color: #555;
}

.record-files {
  margin-top: 20px;
  padding-top: 15px;
  border-top: 1px solid #e9ecef;
}

.record-files strong {
  color: var(--Paraghfont);
}

.record-files strong i {
  margin-right: 8px;
}

.record-files ul {
  margin: 10px 0 0 0;
  padding: 0;
  list-style: none;
}

.record-files li {
  margin: 8px 0;
}

.record-files a {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  color: var(--navcolor);
  text-decoration: none;
  transition: var(--transition);
}

.record-files a:hover {
  color: var(--spanfonts);
}

.file-size {
  font-size: 12px;
  color: #888;
}

.muac-badge {
  display: inline-flex;
  align-items: center;
  gap: 5px;
  padding: 8px 15px;
  border-radius: 20px;
  font-size: 13px;
  font-weight: 500;
}

.muac-green {
  background: rgba(40, 167, 69, 0.1);
  color: #28a745;
}

.muac-yellow {
  background: rgba(255, 193, 7, 0.1);
  color: #ffc107;
}

.muac-red {
  background: rgba(220, 53, 69, 0.1);
  color: #dc3545;
}

@media (max-width: 768px) {
  .record-header {
    flex-direction: column;
    gap: 15px;
  }
}
</style>
